<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lendtech Simulator: Loan Application</title>
    
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary-blue': 'blue',
                        'secondary-gray': 'grey',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: white;
            color: black;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        .container-card {
            background-color: white;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            max-width: 28rem;
            width: 100%;
            border: 1px solid #e2e8f0; /* Use a light gray border for visibility */
        }
        input, select {
            border: 1px solid #e2e8f0; /* Use a light gray border */
            padding: 0.75rem;
            border-radius: 0.5rem;
            width: 100%;
            transition: all 0.2s;
        }
        input:focus, select:focus {
            border-color: blue;
            outline: none;
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
        }
        .message-box {
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 600;
        }
        .bg-success { background-color: white; color: darkgreen; border: 1px solid darkgreen; }
        .bg-danger { background-color: white; color: maroon; border: 1px solid maroon; }
        .bg-warning { background-color: white; color: darkgoldenrod; border: 1px solid darkgoldenrod; }
        .btn {
            background-color: blue;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn:hover {
            background-color: #0000e0; /* A slightly darker blue for hover */
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.2s;
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: blue;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .tab-button:not(.active):hover {
            background-color: #e2e8f0;
        }
    </style>
</head>
<body>

<div class="container-card">
    
    <div class="flex justify-center items-center space-x-2 mb-8">
        <button id="show-app" class="tab-button active">Loan Application</button>
        <button id="show-about" class="tab-button">About Lendtech</button>
    </div>

    <div id="application-page">
        <h1 class="text-3xl font-bold text-center mb-6">Loan Application</h1>
        <p class="text-center text-gray-500 mb-8">Fill in your details to get a decision on your loan application.</p>
        
        <form id="loanForm" class="space-y-6">
            <div>
                <label for="loanamount" class="block text-sm font-medium text-gray-700 mb-1">Loan Amount (£)</label>
                <input type="number" id="loanamount" placeholder="e.g., 5000" class="shadow-sm">
            </div>
            
            <div>
                <label for="loantime" class="block text-sm font-medium text-gray-700 mb-1">Loan Term (Years)</label>
                <select id="loantime" class="shadow-sm">
                    <option value="1">1 year</option>
                    <option value="2">2 years</option>
                    <option value="3">3 years</option>
                    <option value="4">4 years</option>
                    <option value="5">5 years</option>
                </select>
            </div>
            
            <div>
                <label for="annualincome" class="block text-sm font-medium text-gray-700 mb-1">Annual Income (£)</label>
                <input type="number" id="annualincome" placeholder="e.g., 30000" class="shadow-sm">
            </div>

            <div>
                <label for="jobrole" class="block text-sm font-medium text-gray-700 mb-1">Job Title</label>
                <input type="text" id="jobrole" placeholder="e.g., Engineer, Freelancer" class="shadow-sm">
            </div>

            <div>
                <label for="creditscore" class="block text-sm font-medium text-gray-700 mb-1">Credit Score (300-850)</label>
                <input type="number" id="creditscore" placeholder="e.g., 750" class="shadow-sm">
            </div>

            <div>
                <label for="savings" class="block text-sm font-medium text-gray-700 mb-1">Current Savings (£)</label>
                <input type="number" id="savings" placeholder="e.g., 1000" class="shadow-sm">
            </div>
            
            <div class="pt-4">
                <button type="submit" class="btn w-full">Submit</button>
            </div>
        </form>
        
        <div id="result" class="mt-8 hidden">
            <h2 class="text-xl font-semibold mb-4 text-center">Application Decision</h2>
            <div id="resultBox" class="message-box"></div>
        </div>
        
        <div id="calculation-result" class="mt-8 hidden">
            <h2 class="text-xl font-semibold mb-4 text-center">Your Estimated Repayment</h2>
            <div class="message-box bg-gray-100 text-gray-800 text-center border border-gray-200">
                <p>Your estimated monthly repayment would be: <strong id="monthly-payment" class="text-primary-blue text-lg"></strong></p>
                <p class="text-xs text-gray-500 mt-1">
                    *Based on a fixed 7% annual interest rate.
                </p>
            </div>
        </div>
    </div>

    
    <div id="about-page" class="hidden">
        <h1 class="text-3xl font-bold text-center mb-6">What is Lendtech?</h1>
        <p class="text-gray-600 mb-6 leading-relaxed">
            Lendtech uses modern technology, such as mobile apps and data analysis, to improve the loan application process. This means faster decisions can be made, with a much simpler user experience compared to going into a traditional bank and having a lenghty meeting with a Loan Advisor.
        </p>

        <h2 class="text-xl font-bold mb-4">Eligibility?</h2>
        <p class="text-gray-600 mb-4 leading-relaxed">
            In this simulator, loan decisions are based on a few key factors reflecting common lending criteria. In the real world there would be many more variables analysed.
        </p>
        
        <ul class="list-disc list-inside space-y-2 text-gray-700">
            <li>
                <strong class="font-semibold">Income:</strong> Lending Companies want to ensure that you have the financial income to repay the loan without difficulty.
            </li>
            <li>
                <strong class="font-semibold">Loan-to-Income Ratio:</strong> This measures how much an individual borrows compared to how much they earn. A loan that is a high percentage of your income (e.g. >50%) is considered high risk (Vice Versa).
            </li>
            <li>
                <strong class="font-semibold">Loan Term:</strong> The duration of the loan. Longer terms can lower monthly payments however they can also increase the overall interest paid.
            </li>
        </ul>

        <h2 class="text-xl font-bold mb-4 mt-8">How Loan Repayment is Calculated</h2>
        <p class="text-gray-600 mb-4 leading-relaxed">
            Loan repayment is based on one formula. The formula calculates the fixed monthly payment needed to pay off both the loan and the amount of interest over the complete loan period.
        </p>
        
        <p class="text-gray-600 mt-6 leading-relaxed">
            This formula makes sure that a piece of each monthly paymenty goes towards paying the principal and the other goes towards the interest.
        </p>

        <h2 class="text-xl font-bold mb-4 mt-8">UK Loan Application Statistics</h2>
        <div class="flex justify-center">
            <div class="w-full max-w-sm">
                <canvas id="loanChart"></canvas>
            </div>
        </div>
        <p class="text-center text-gray-500 text-sm mt-4">
            Source: Based on general UK lending data. Individual lender approval rates will vary.
        </p>

        <h2 class="text-xl font-bold mb-4 mt-8">Additional Factors for Approval</h2>
        <p class="text-gray-600 mb-4 leading-relaxed">
            Lenders don't just look at income and loan amount. They take other factors into consideration. They view a person's total financial health. This simulator includes the following factors below to provide a more realistic decision:
        </p>

        <ul class="list-disc list-inside space-y-2 text-gray-700">
            <li>
                <strong class="font-semibold">Credit Score:</strong> Key indicator of  past financial behavior. High score suggests a history of responsible borrowing and repayment such as Car Payments or Bills/Mortgage.
            </li>
            <li>
                <strong class="font-semibold">Employment Status:</strong> Having a stable job is a strong sign of reliable income.
            </li>
            <li>
                <strong class="font-semibold">Current Savings:</strong> Savings act as a buffer and show that an individual has the means to handle unexpected expenses, making them a low-risk borrower.
            </li>
        </ul>
    </div>
</div>

<script>
    
    document.getElementById('loanForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const loanamount = parseFloat(document.getElementById('loanamount').value);
        const annualincome = parseFloat(document.getElementById('annualincome').value);
        const loantime = parseInt(document.getElementById('loantime').value);
        const jobrole = document.getElementById('jobrole').value.toLowerCase();
        const creditscore = parseInt(document.getElementById('creditscore').value);
        const savingsAmount = parseFloat(document.getElementById('savings').value);
        
        const resultDiv = document.getElementById('result');
        const resultBox = document.getElementById('resultBox');
        const calculationDiv = document.getElementById('calculation-result');
        const monthlyPaymentSpan = document.getElementById('monthly-payment');

        resultDiv.classList.add('hidden');
        resultBox.className = 'message-box';
        resultBox.innerHTML = '';
        calculationDiv.classList.add('hidden');
        monthlyPaymentSpan.textContent = '';

        if (isNaN(loanamount) || isNaN(annualincome) || isNaN(creditscore) || isNaN(savingsAmount) || loanamount <= 0 || annualincome <= 0 || creditscore < 300 || creditscore > 850) {
            resultDiv.classList.remove('hidden');
            resultBox.classList.add('bg-danger');
            resultBox.innerHTML = '<strong>Error:</strong> Please enter valid numbers and a credit score between 300 and 850.';
            return; 
        }

        let decision = '';
        let message = '';
        let reasoning = '';
        let score = 0;

        
        const loanIncomeRatio = loanamount / annualincome;
        if (loanIncomeRatio < 0.25) {
            score += 2;
        } else if (loanIncomeRatio < 0.5) {
            score += 1;
        } else {
            score -= 2; 
        }

        
        if (creditscore >= 700) {
            score += 3;
        } else if (creditscore >= 580) {
            score += 1;
        } else {
            score -= 3; 
        }

        const highRiskJobs = ['unemployed', 'freelancer', 'gig worker','lorry driver'];
        const lowRiskJobs = ['doctor', 'nurse', 'teacher', 'engineer', 'civil servant', 'accountant','pharmacist','teacher'];
        

        if (highRiskJobs.some(job => jobrole.includes(job))) {
            score -= 1;
        } else if (lowRiskJobs.some(job => jobrole.includes(job))) {
            score += 1;
        }
        
        const monthlyPaymentEstimate = (loanamount / loantime) * 1.07; 
        if (savingsAmount > monthlyPaymentEstimate * 3) {
            score += 1;
        }

    
        if (score >= 4) {
            decision = 'approved';
            message = 'Congratulations! Your loan application has been approved!';
            reasoning = `Your application was successful, due to your strong credit score and manageable loan-to-income ratio.`;
        } else if (score >= 0) {
            decision = 'referred';
            message = 'Your application requires further review. A member of our team will contact you shortly.';
            reasoning = 'Your application shows potential, but a combination of factors, such as credit score or employment, requires a manual review.';
        } else {
            decision = 'declined';
            message = 'Your application has been declined based on the lending criteria.';
            reasoning = `Your application was declined due to high-risk factors, including your credit score, income and employment status.`;
        }

        const annualInterestRate = 0.07; 
        const monthlyInterestRate = annualInterestRate / 12;
        const numberOfPayments = loantime * 12;
        
        let monthlyPayment;
        if (monthlyInterestRate > 0) {
            
            // Loan payment formula
            monthlyPayment = (loanamount * monthlyInterestRate) / (1 - Math.pow(1 + monthlyInterestRate, -numberOfPayments));
        } else {
            // 0% interest rate is division
            monthlyPayment = loanamount / numberOfPayments;
        }
        
        resultDiv.classList.remove('hidden');
        calculationDiv.classList.remove('hidden');
        monthlyPaymentSpan.textContent = `£${monthlyPayment.toFixed(2)}`;

        
        if (decision === 'approved') {
            resultBox.classList.add('bg-success');
        } else if (decision === 'declined') {
            resultBox.classList.add('bg-danger');
        } else {
            resultBox.classList.add('bg-warning');
        }
        
        resultBox.innerHTML = `
            <div><strong>${message}</strong></div>
            <div class="mt-2 text-sm">${reasoning}</div>
        `;
    });

    
    const showAppButton = document.getElementById('show-app');
    const showAboutButton = document.getElementById('show-about');
    const appPage = document.getElementById('application-page');
    const aboutPage = document.getElementById('about-page');

    showAppButton.addEventListener('click', () => {
        appPage.classList.remove('hidden');
        aboutPage.classList.add('hidden');
        showAppButton.classList.add('active');
        showAboutButton.classList.remove('active');
    });

    showAboutButton.addEventListener('click', () => {
        appPage.classList.add('hidden');
        aboutPage.classList.remove('hidden');
        showAboutButton.classList.add('active');
        showAppButton.classList.remove('active');
    });

    window.onload = function() {
        const ctx = document.getElementById('loanChart').getContext('2d');
        const loanChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Approved', 'Rejected'],
                datasets: [{
                    data: [70, 30], 
                    backgroundColor: [
                        'lightblue', 
                        'black' 
                    ],
                    hoverOffset: 4,
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            color: '#1a202c' 
                        }
                    },
                    title: {
                        display: true,
                        text: 'UK Personal Loan Application Outcomes',
                        font: {
                            size: 16,
                            weight: 'bold'
                        },
                        color: '#1a202c'
                    }
                }
            }
        });
    };
</script>

</body>
</html>
